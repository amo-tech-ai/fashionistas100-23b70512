import{j as e}from"./ui-vendor-CWP_eYGj.js";import{f as T,r as C}from"./react-vendor-BCzOm2YP.js";import{B as w,m as S,a as p,C as u,b as j,c as b,d as v}from"./index-hD8Lc50L.js";import{S as F}from"./scroll-area-DkBki9q3.js";import{A as q,b as L,a as E}from"./avatar-DdPqRXcW.js";import{D as U}from"./DashboardLayout-C-PEpEIB.js";import{u as y}from"./useQuery-B78G5QkG.js";import{s as h}from"./supabase-h9YFjl6R.js";import{u as $}from"./clerk-dvj8YAJP.js";import{L as z,_ as A,v as O,w as H,n as Q,k as _,D as I,aY as K,g as P,E as R,$ as V,C as W,H as B,W as Y}from"./utils-CgNX-I3X.js";const G=()=>{var D;const{user:a}=$(),t=(D=a==null?void 0:a.primaryEmailAddress)==null?void 0:D.emailAddress,i=a==null?void 0:a.id,c=y({queryKey:["user-tickets",i],queryFn:async()=>{const{data:l,error:n}=await h.from("event_registrations").select(`
          *,
          events (
            id,
            event_name,
            start_datetime,
            end_datetime,
            venue_id,
            status
          )
        `).eq("user_id",i||"guest").order("created_at",{ascending:!1});n&&console.error("Registration error:",n);const{data:d,error:o}=await h.from("bookings").select(`
          *,
          events (
            id,
            event_name,
            start_datetime,
            venue_id
          )
        `).or(`user_id.eq.${i},customer_email.eq.${t}`).order("created_at",{ascending:!1});return o&&console.error("Booking error:",o),{registrations:l||[],bookings:d||[],total:((l==null?void 0:l.length)||0)+((d==null?void 0:d.length)||0)}}}),r=y({queryKey:["user-upcoming-events"],queryFn:async()=>{const{data:l,error:n}=await h.from("events").select("*").in("status",["active","upcoming","published"]).gte("start_datetime",new Date().toISOString()).order("start_datetime",{ascending:!0}).limit(6);return n&&console.error("Events error:",n),l||[]}}),m=y({queryKey:["user-favorites",i],queryFn:async()=>{const{data:l,error:n}=await h.from("designer_profiles").select("*").limit(4);n&&console.error("Designer error:",n);const{data:d,error:o}=await h.from("venues").select("*").limit(4);return o&&console.error("Venue error:",o),{designers:l||[],venues:d||[]}}}),g=y({queryKey:["user-stats",i],queryFn:async()=>{const l=z(new Date,30),{count:n}=await h.from("event_registrations").select("*",{count:"exact",head:!0}).eq("user_id",i||"guest").eq("status","confirmed"),{count:d}=await h.from("bookings").select("*",{count:"exact",head:!0}).or(`user_id.eq.${i},customer_email.eq.${t}`),{data:o}=await h.from("bookings").select("total_amount").or(`user_id.eq.${i},customer_email.eq.${t}`).gte("created_at",l.toISOString()),N=(o==null?void 0:o.reduce((f,s)=>f+(s.total_amount||0),0))||0;return{eventsAttended:n||0,totalBookings:d||0,totalSpent:N,memberSince:a!=null&&a.createdAt?A(new Date(a.createdAt),"MMM yyyy"):"New Member"}}});return{tickets:c.data,upcomingEvents:r.data,favorites:m.data,stats:g.data,isLoading:c.isLoading||r.isLoading||m.isLoading||g.isLoading,user:{name:(a==null?void 0:a.fullName)||(a==null?void 0:a.firstName)||"Fashion Enthusiast",email:t||"",image:a==null?void 0:a.imageUrl}}},M=()=>{var n,d,o,N,f;const a=T();C.useState("events");const{tickets:t,upcomingEvents:i,favorites:c,stats:r,isLoading:m,user:g}=G(),l=(()=>{const s=(r==null?void 0:r.eventsAttended)||0;return s>=20?{name:"Platinum",color:"bg-purple-500"}:s>=10?{name:"Gold",color:"bg-yellow-500"}:s>=5?{name:"Silver",color:"bg-gray-400"}:{name:"Bronze",color:"bg-orange-600"}})();return e.jsx(U,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-gray-50 to-gray-100",children:e.jsxs("div",{className:"container mx-auto max-w-[1400px] px-4 sm:px-6 lg:px-8 py-6 lg:py-8",children:[e.jsxs("div",{className:"mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(q,{className:"h-16 w-16 ring-2 ring-white shadow-xl",children:[e.jsx(L,{src:g.image,alt:g.name}),e.jsx(E,{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white",children:g.name.split(" ").map(s=>s[0]).join("")})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900",children:["Welcome back, ",g.name,"!"]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs(w,{className:S("text-white",l.color),children:[l.name," Member"]}),e.jsxs("span",{className:"text-gray-600",children:["Member since ",(r==null?void 0:r.memberSince)||"Recently"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{variant:"outline",size:"icon",className:"bg-white",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(p,{variant:"outline",size:"icon",className:"bg-white",children:e.jsx(H,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4 lg:gap-6 mb-8",children:[e.jsxs(u,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-purple-500 to-purple-600",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-16 -mt-16"}),e.jsx(j,{className:"pb-3",children:e.jsxs(b,{className:"text-sm font-medium text-white/90 flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(Q,{className:"h-5 w-5 text-white"})}),"Events Attended"]})}),e.jsxs(v,{children:[e.jsx("div",{className:"text-4xl font-bold text-white mb-1",children:m?"...":(r==null?void 0:r.eventsAttended)||0}),e.jsx("p",{className:"text-sm text-white/80",children:"Lifetime"})]})]}),e.jsxs(u,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-green-500 to-emerald-600",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-16 -mt-16"}),e.jsx(j,{className:"pb-3",children:e.jsxs(b,{className:"text-sm font-medium text-white/90 flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(_,{className:"h-5 w-5 text-white"})}),"Active Tickets"]})}),e.jsxs(v,{children:[e.jsx("div",{className:"text-4xl font-bold text-white mb-1",children:m?"...":(t==null?void 0:t.total)||0}),e.jsx("p",{className:"text-sm text-white/80",children:"Upcoming"})]})]}),e.jsxs(u,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-orange-500 to-amber-600",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-16 -mt-16"}),e.jsx(j,{className:"pb-3",children:e.jsxs(b,{className:"text-sm font-medium text-white/90 flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(I,{className:"h-5 w-5 text-white"})}),"Amount Spent"]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"text-4xl font-bold text-white mb-1",children:["$",m?"...":((r==null?void 0:r.totalSpent)||0).toFixed(0)]}),e.jsx("p",{className:"text-sm text-white/80",children:"Last 30 days"})]})]}),e.jsxs(u,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-pink-500 to-rose-600",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-16 -mt-16"}),e.jsx(j,{className:"pb-3",children:e.jsxs(b,{className:"text-sm font-medium text-white/90 flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(K,{className:"h-5 w-5 text-white"})}),"Loyalty Points"]})}),e.jsxs(v,{children:[e.jsx("div",{className:"text-4xl font-bold text-white mb-1",children:((r==null?void 0:r.eventsAttended)||0)*100}),e.jsx("p",{className:"text-sm text-white/80",children:"Available"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(u,{className:"border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(j,{className:"bg-gradient-to-r from-purple-50 to-purple-100/50 border-b border-purple-200/30",children:e.jsxs(b,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-3 text-purple-900",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"My Bookings & Tickets"})]}),e.jsx(p,{size:"sm",variant:"ghost",className:"hover:bg-purple-200/30",children:"View All"})]})}),e.jsx(v,{className:"p-6",children:e.jsx(F,{className:"h-[400px] pr-4",children:m?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},s))}):(((n=t==null?void 0:t.registrations)==null?void 0:n.length)||0)+(((d=t==null?void 0:t.bookings)==null?void 0:d.length)||0)>0?e.jsxs("div",{className:"space-y-4",children:[(o=t==null?void 0:t.registrations)==null?void 0:o.map(s=>{var x,k;return e.jsxs("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100/50 rounded-xl hover:from-purple-50 hover:to-purple-100/30 transition-all duration-200 cursor-pointer group border border-gray-200/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 group-hover:text-purple-700 transition-colors",children:((x=s.events)==null?void 0:x.event_name)||"Event"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1 flex items-center gap-2",children:[e.jsx(P,{className:"h-3 w-3"}),(k=s.events)!=null&&k.start_datetime?A(new Date(s.events.start_datetime),"MMM dd, yyyy â€¢ HH:mm"):"Date TBD"]})]}),e.jsx(w,{variant:"outline",className:S("border-green-200",s.status==="confirmed"?"bg-green-50 text-green-700":"bg-yellow-50 text-yellow-700"),children:s.status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Registration #",s.id.slice(0,8)]}),e.jsxs(p,{size:"sm",variant:"ghost",className:"hover:bg-purple-100",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"View Details"]})]})]},s.id)}),(N=t==null?void 0:t.bookings)==null?void 0:N.map(s=>{var x;return e.jsxs("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100/50 rounded-xl hover:from-purple-50 hover:to-purple-100/30 transition-all duration-200 cursor-pointer group border border-gray-200/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 group-hover:text-purple-700 transition-colors",children:((x=s.events)==null?void 0:x.event_name)||"Booking"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Booking Code: ",s.booking_code||s.id.slice(0,8)]})]}),e.jsx(w,{variant:"outline",className:S("border-green-200",s.status==="confirmed"?"bg-green-50 text-green-700":s.status==="pending"?"bg-yellow-50 text-yellow-700":"bg-gray-50 text-gray-700"),children:s.status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-semibold text-green-600",children:["$",s.total_amount||0]}),e.jsxs(p,{size:"sm",variant:"ghost",className:"hover:bg-purple-100",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"View Ticket"]})]})]},s.id)})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No bookings yet"}),e.jsx(p,{onClick:()=>a("/events"),children:"Browse Events"})]})})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{className:"border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(j,{className:"bg-gradient-to-r from-pink-50 to-pink-100/50 border-b border-pink-200/30",children:e.jsxs(b,{className:"flex items-center gap-3 text-pink-900",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"For You"})]})}),e.jsxs(v,{className:"p-6",children:[e.jsx("div",{className:"space-y-4",children:m?e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]}):i==null?void 0:i.slice(0,3).map((s,x)=>e.jsxs("div",{className:"group cursor-pointer",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("div",{className:"h-32 bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center",children:e.jsx(W,{className:"h-8 w-8 text-white/50"})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs(w,{className:"bg-white/90 text-purple-700",children:[Math.floor(Math.random()*30+70),"% Match"]})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 group-hover:text-purple-700 transition-colors",children:s.event_name||s.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.start_datetime?A(new Date(s.start_datetime),"MMM dd"):"Date TBD"})]})]},s.id))}),i&&i.length>0&&e.jsx(p,{className:"w-full mt-4",variant:"outline",children:"Discover More Events"})]})]}),e.jsxs(u,{className:"border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(j,{className:"bg-gradient-to-r from-orange-50 to-orange-100/50 border-b border-orange-200/30",children:e.jsxs(b,{className:"flex items-center gap-3 text-orange-900",children:[e.jsx(B,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Favorite Designers"})]})}),e.jsx(v,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[m?e.jsx("div",{className:"animate-pulse space-y-2",children:[1,2].map(s=>e.jsx("div",{className:"h-12 bg-gray-200 rounded-lg"},s))}):(f=c==null?void 0:c.designers)==null?void 0:f.slice(0,3).map(s=>{var x;return e.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg transition-colors cursor-pointer",children:[e.jsx(q,{className:"h-10 w-10",children:e.jsx(E,{className:"bg-gradient-to-r from-purple-400 to-pink-400 text-white",children:((x=s.brand_name)==null?void 0:x[0])||"D"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.brand_name||"Designer"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.style_category||"Fashion"})]}),e.jsx(Y,{className:"h-4 w-4 text-yellow-500 fill-current"})]},s.id)}),(!(c!=null&&c.designers)||c.designers.length===0)&&!m&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx(B,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Follow your favorite designers"})]})]})})]})]})]})]})})})},ne=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"})),oe=Object.freeze(Object.defineProperty({__proto__:null,UserDashboard:M,default:M},Symbol.toStringTag,{value:"Module"}));export{ne as U,oe as a};
