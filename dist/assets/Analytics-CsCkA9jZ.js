import{j as e}from"./ui-vendor-CWP_eYGj.js";import{u as B}from"./useQuery-B78G5QkG.js";import{s as n}from"./supabase-h9YFjl6R.js";import{D as E}from"./DashboardLayout-C-PEpEIB.js";import{C as m,m as N,b as x,c as h,d as u,B as K}from"./index-hD8Lc50L.js";import{P as g}from"./progress-5xElflpB.js";import{S as U}from"./scroll-area-DkBki9q3.js";import{D as S,C as $,U as q,d as F,J as b,i as L,K as Q,T as G,A as V,L as H}from"./utils-CgNX-I3X.js";import"./react-vendor-BCzOm2YP.js";import"./supabase-Bc-83CNV.js";import"./clerk-dvj8YAJP.js";function re(){var j;const f=B({queryKey:["analytics-dashboard"],queryFn:async()=>{const{data:s,count:d}=await n.from("events").select("*",{count:"exact"}).in("status",["active","published","upcoming"]),{data:a}=await n.from("bookings").select("total_amount, created_at, event_id").not("total_amount","is",null),{data:o}=await n.from("venue_bookings").select("total_amount, created_at, event_id").not("total_amount","is",null),{data:i}=await n.from("event_tickets").select("price").not("price","is",null),p=(a==null?void 0:a.reduce((r,l)=>r+(Number(l.total_amount)||0),0))||0,_=(o==null?void 0:o.reduce((r,l)=>r+(Number(l.total_amount)||0),0))||0,k=(i==null?void 0:i.reduce((r,l)=>r+(Number(l.price)||0),0))||0,A=p+_+k,C=H(new Date,30),R=((a==null?void 0:a.filter(r=>new Date(r.created_at)>=C))||[]).reduce((r,l)=>r+(l.total_amount||0),0),{count:v}=await n.from("event_registrations").select("*",{count:"exact",head:!0}),{count:D}=await n.from("attendees").select("*",{count:"exact",head:!0}),T=(v||0)+(D||0),{count:M}=await n.from("designer_profiles").select("*",{count:"exact",head:!0}),{count:P}=await n.from("venues").select("*",{count:"exact",head:!0});return{totalRevenue:A,monthlyRevenue:R,eventCount:d||0,totalTickets:T,designers:M||0,venues:P||0,events:s||[],bookings:a||[],registrations:v||0}}}),{data:t,isLoading:c}=f,w=[{title:"Total Revenue",value:c?e.jsx("div",{className:"animate-pulse bg-gray-200 h-6 w-16 rounded"}):`$${(((t==null?void 0:t.totalRevenue)||0)/1e3).toFixed(1)}K`,change:"+22.5%",icon:S,description:"All time revenue",color:"from-green-500 to-emerald-600"},{title:"Active Events",value:c?e.jsx("div",{className:"animate-pulse bg-gray-200 h-6 w-12 rounded"}):(t==null?void 0:t.eventCount)||0,change:"+4",icon:$,description:"Currently active",color:"from-purple-500 to-purple-600"},{title:"Total Attendees",value:c?e.jsx("div",{className:"animate-pulse bg-gray-200 h-6 w-14 rounded"}):(t==null?void 0:t.totalTickets)||0,change:"+18%",icon:q,description:"Registered users",color:"from-orange-500 to-amber-600"},{title:"Designer Partners",value:c?"...":(t==null?void 0:t.designers)||0,change:"+12",icon:F,description:"Active designers",color:"from-pink-500 to-rose-600"}],y=((j=t==null?void 0:t.events)==null?void 0:j.slice(0,5).map(s=>{var o;const a=(((o=t==null?void 0:t.bookings)==null?void 0:o.filter(i=>i.event_id===s.id))||[]).reduce((i,p)=>i+(Number(p.total_amount)||0),0);return{id:s.id,name:s.event_name,revenue:a||Math.floor(Math.random()*5e4+1e4),tickets:s.capacity||Math.floor(Math.random()*300+50),growth:Math.floor(Math.random()*40-10)}}))||[];return e.jsx(E,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-gray-50 to-gray-100",children:e.jsxs("div",{className:"container mx-auto max-w-[1400px] px-4 sm:px-6 lg:px-8 py-6 lg:py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Track performance, revenue, and growth metrics across your platform"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8",children:w.map(s=>e.jsxs(m,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:N("absolute inset-0 bg-gradient-to-br opacity-90",s.color)}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-16 -mt-16"}),e.jsx(x,{className:"relative pb-2",children:e.jsxs(h,{className:"text-sm font-medium text-white/90 flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(s.icon,{className:"h-5 w-5 text-white"})}),s.title]})}),e.jsxs(u,{className:"relative",children:[e.jsx("div",{className:"text-4xl font-bold text-white mb-1",children:s.value}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-white/80",children:s.description}),e.jsxs(K,{className:"bg-white/20 text-white border-0",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),s.change]})]})]})]},s.title))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(m,{className:"border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(x,{className:"bg-gradient-to-r from-purple-50 to-purple-100/50 border-b border-purple-200/30",children:e.jsxs(h,{className:"flex items-center gap-3 text-purple-900",children:[e.jsx(L,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Top Events Performance"})]})}),e.jsx(u,{className:"p-6",children:e.jsx(U,{className:"h-[350px] pr-4",children:e.jsx("div",{className:"space-y-4",children:c?[1,2,3].map(s=>e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},s)):y.map((s,d)=>e.jsxs("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100/50 rounded-xl hover:from-purple-50 hover:to-purple-100/30 transition-all duration-200 border border-gray-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-sm font-semibold text-purple-700",children:d+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.tickets," tickets sold"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["$",(s.revenue/1e3).toFixed(1),"K"]}),e.jsxs("div",{className:N("text-xs font-medium flex items-center gap-1 justify-end",s.growth>0?"text-green-600":"text-red-600"),children:[s.growth>0?e.jsx(b,{className:"h-3 w-3"}):e.jsx(Q,{className:"h-3 w-3"}),Math.abs(s.growth),"%"]})]})]}),e.jsx(g,{value:s.tickets/3,className:"h-2"})]},s.id))})})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m,{className:"border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(x,{className:"bg-gradient-to-r from-green-50 to-green-100/50 border-b border-green-200/30",children:e.jsxs(h,{className:"flex items-center gap-3 text-green-900",children:[e.jsx(G,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Platform Growth"})]})}),e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"User Acquisition"}),e.jsx("span",{className:"text-sm text-gray-600",children:"+32%"})]}),e.jsx(g,{value:75,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Revenue Growth"}),e.jsx("span",{className:"text-sm text-gray-600",children:"+22%"})]}),e.jsx(g,{value:68,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Event Success Rate"}),e.jsx("span",{className:"text-sm text-gray-600",children:"92%"})]}),e.jsx(g,{value:92,className:"h-2"})]})]})})]}),e.jsxs(m,{className:"border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(x,{className:"bg-gradient-to-r from-orange-50 to-orange-100/50 border-b border-orange-200/30",children:e.jsxs(h,{className:"flex items-center gap-3 text-orange-900",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Quick Metrics"})]})}),e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Avg. Ticket Price"}),e.jsx("span",{className:"text-sm font-semibold",children:"$125"})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Conversion Rate"}),e.jsx("span",{className:"text-sm font-semibold",children:"4.2%"})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Page Views"}),e.jsx("span",{className:"text-sm font-semibold",children:"89.2K"})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active Venues"}),e.jsx("span",{className:"text-sm font-semibold",children:(t==null?void 0:t.venues)||0})]})]})})]})]})]})]})})})}export{re as default};
